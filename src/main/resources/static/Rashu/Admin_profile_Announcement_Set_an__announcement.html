<html lang="en">
<head>
    <title>
        Set An A Announcements
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="Admin_profile_body_background.css">
    <link rel="stylesheet" href="Admin_profile_menu-bar.css">
    <link rel="stylesheet" href="Admin_profile_main-content.css">
    <link rel="stylesheet" href="Admin_profile_form.css">
    <link rel="stylesheet" href="Pagination.css">
    <link rel="stylesheet" href="Admin_profile_header_search_bar.css">
    <link rel="stylesheet" href="Admin_profile_footer.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</head>
<body>
<header>
    <div class="backgrounding">
        <div class="menubar">
            <img src="design_logo_02.jpg" class="logo">

            <ul style="color:white; padding: 5px;" >

                <li><i class="fas fa-user-circle" style="color: white;"></i><span style="color:white; padding: 5px" id="adminName"> </span></li>
            </ul>
        </div>
    </div>
</header>

<main class="content_main">
    <div class="menu-bar">
        <ul>
            <li><a href="/home"><i class="fa fa-home "></i> Home</a></li>
            <li><a href="Admin_profile_my_profile.html"><i class="fa fa-user "></i> My profile</a></li>
            <li><a href="Admin_profile_Designs.html"><i class="fas fa-list-ul "></i> Designs</a></li>

            <li><a href="Admin_profile_Designers.html"><i class="fa fa-users"></i> Designers</a></li>
            <li><a href="Admin_profile_Users.html"><i class="fa fa-users"></i> Users</a></li>
            <li><a href="Admin_profile_Users.html"><i class="fa fa-users"></i> Admins</a></li>
            <li><a href="#"><i class="fas fa-trophy contest-icon "></i> My contest</a>
                <div class="sub-menu-2">
                    <ul>
                        <li><a href="Admin_profile_Mycontest_contest_request.html">Contest Requests</a></li>
                        <li><a href="Admin_profile_Mycontest_previous_contest.html">Previous Contest</a></li>
                        <li><a href="Admin_profile_Mycontest_Set_A_Contest.html">Set A Contest</a></li>
                    </ul>
                </div>
            </li>
            <li><a href="Admin_profile_Inbox.html"><i class="fas fa-inbox inbox-icon"></i> Inbox</a></li>
            <li class="active" ><a ><i class="fas fa-bullhorn announcement-icon "></i> Announcements</a>
                <div class="sub-menu-2">
                    <ul>
                        <li><a href="Admin_profile_Announcement_previous_announcement.html">Previous Announcement</a></li>
                        <li><a href="#">Set An Announcement</a></li>
                    </ul>
                </div>
            </li>

            <li><a href="#"><i class="fas fa-cog profile-settings-icon "></i> Profile Setting</a>
                <div class="sub-menu-2">
                    <ul>
                        <li><a href="Admin_profile_Edit_Profile_update_details.html">Update Details</a></li>
                        <li><a href="Admin_profile_Edit_Profile_Change_password.html">Change Password</a></li>

                    </ul>
                </div>
            </li>
            <li onclick="logout()"><a href="" ><i class="fas fa-sign-out-alt"></i> Logout</a></li>

        </ul>
    </div>

    <div class="container">
        <h2 style="color:#967d00;text-align: center;">Set An Announcement</h2>
        <form id="announcementForm" action="javascript:void(0);" method="post">
            <div class="form-group">
                <label for="anc_Title">Title</label>
                <input type="text" id="anc_Title" name="anc_Title" placeholder="Must be less than 70 character" required>
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" rows="4" placeholder="Must be less than 1000 character" required></textarea>
            </div>
            <div class="form-group">
                <label for="confirmPassword">Confirmation Password</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required>
            </div>
            <div class="form-group">
                <button type="submit" class="btn" onclick="validateAndSubmit()">Set Announcement</button>
            </div>
        </form>
        <div class="popup" id="successPopup">
            <img src="tick01.png">
            <h2 style="color: #4CAF50">Success</h2>
            <p>Your Announcement has been set successfully.</p>
            <button type="button" onclick="closeSuccessPopup()">OK</button>
        </div>
        <div class="popup" id="errorPopup">
            <h2 style="color: #b30021">Error</h2>
            <p id="errorText"></p>
            <button type="button" onclick="closeErrorPopup()">OK</button>
        </div>
    </div>


</main>

<footer class="footer">
    <div class="container_ftr">
        <div class="row">
            <div class="footer-col">
                <ul>
                    <li>&copy; COPYRIGHT Reserved by</li>
                    <li>Digital Art Design </li>
                </ul>
            </div>
            <div class="footer-col">
                <ul>
                    <div class="contact">
                        <li>Contact Information:</li>
                        <li>Address: Chittagong ,Bangladesh</li>
                        <li>Phone: <a href="tel:+15551234567">(555) 123-4567</a></li>
                        <li>Email: <a href="mailto:info@example.com">info@example.com</a></li>
                    </div>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Help</h4>
                <ul>
                    <li><a href="Admin_profile_About_Us.html">about us</a></li>
                    <li><a href="Admin_profile_Our_Services.html">our services</a></li>
                    <li><a href="Admin_profile_FAQ.html">FAQ</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>follow us</h4>
                <div class="social-links">
                    <a ><i class="fab fa-facebook-f"></i></a>
                    <a ><i class="fab fa-twitter"></i></a>
                    <a ><i class="fab fa-instagram"></i></a>
                    <a ><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
    </div>
</footer>
<script>
    console.log("Script is running");


    let errorText = document.getElementById("errorText");

    const admin_nameContainer = document.getElementById("adminName");

    const Admin_Name = sessionStorage.getItem('Admin_Name');
    console.log(Admin_Name);
    admin_nameContainer.innerHTML = Admin_Name;
    // Function to logout and redirect to home page
    function logout() {
        sessionStorage.removeItem("Admin_id"); // Remove the Admin_id from session storage
        window.location.href = "/home";
    }

    // Function to check if Admin_id is null and redirect to home page if null
    function checkAdminId() {
        let id = sessionStorage.getItem("Admin_id");
        if (id === null) {
            window.location.href = "/home";
            return null; // Return null if Admin_id is null
        }
        return id; // Return Admin_id if it exists
    }
    // Check if Admin_id is null on page load
    document.addEventListener("DOMContentLoaded", function () {
        checkAdminId();
    });
    window.addEventListener("beforeunload", function(event) {
        const id = sessionStorage.getItem("Admin_id");
        if (id === null) {
            sessionStorage.removeItem("Admin_id");
        }
    });
    // Function to open success popup
    function openSuccessPopup() {
        let popup = document.getElementById("successPopup");
        popup.classList.add("open-popup");
    }

    // Function to close success popup and reload the page
    function closeSuccessPopup() {
        let popup = document.getElementById("successPopup");
        popup.classList.remove("open-popup");
        location.reload();
    }

    // Function to open error popup
    function openErrorPopup() {
        let errorPopup = document.getElementById("errorPopup");
        errorPopup.classList.add("open-popup");
    }

    // Function to close error popup
    function closeErrorPopup() {
        let errorPopup = document.getElementById("errorPopup");
        errorPopup.classList.remove("open-popup");
    }

    // Function to validate form inputs and submit form
    function validateAndSubmit() {
        const anc_Title = document.getElementById("anc_Title").value;
        const description = document.getElementById("description").value;
        const confirmPassword = document.getElementById("confirmPassword").value;

        // Validate form inputs
        if (!anc_Title || !description || !confirmPassword) {
            errorText.textContent = " Please fill in all required fields.";
            openErrorPopup();
        } else if (description.length > 1000) {
            errorText.textContent = " Description should be less than 1000 characters.";
            openErrorPopup();
        } else if (anc_Title.length > 70) {
            errorText.textContent = " Announcement Title should be less than 70 characters.";
            openErrorPopup();
        } else {
            submitForm();
        }
    }

    // Function to submit form data
    function submitForm() {
        const anc_Title = document.getElementById("anc_Title").value;
        const description = document.getElementById("description").value;
        const confirmPassword = document.getElementById("confirmPassword").value;
        const id = sessionStorage.getItem("Admin_id");

        const data = {
            anc_Title,
            description,
            confirmPassword,
            id,
        };

        // Send POST request to server
        fetch('/api/Rashu_SetAnnouncement', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
            .then((response) => {
                if (response.status === 200) {
                    return response.text();
                } else {
                    return response.json().then((error) => Promise.reject(error.message));
                }
            })
            .then((data) => {
                openSuccessPopup();
            })
            .catch((error) => {
                openErrorPopup();
            });
    }


</script>
</body>
</html>